ktor {
  application {
    modules = [ com.yourcompany.zeiterfassung.ApplicationKt.module ]
  }

  deployment {
    host = "0.0.0.0"
    port = 8080
    port = ${?PORT}
  }

  database {
    driver          = "org.postgresql.Driver"
    # Local dev default URL (no secrets here). For prod, override via env below.
    url             = "jdbc:postgresql://localhost:5432/attendance"
    maximumPoolSize = 10

    # --- overrides for Koyeb/Neon via env ---
    url             = ${?JDBC_DATABASE_URL}
    user            = ${?DB_USER}
    password        = ${?DB_PASSWORD}
    maximumPoolSize = ${?DB_MAX_POOL}
  }

  jwt {
    # --- safe dev defaults; production overrides via env ---
    secret   = "dev-secret"
    issuer   = "dev-issuer"
    audience = "dev-audience"
    realm    = "zeiterfassung"
    validityMs = 3600000

    secret   = ${?JWT_SECRET}
    issuer   = ${?JWT_ISSUER}
    audience = ${?JWT_AUDIENCE}
    realm    = ${?JWT_REALM}
  }
}

twilio {
  # safe dev defaults; override via env in prod
  accountSid = "dev"
  authToken  = "dev"
  fromNumber = "+10000000000"

  accountSid = ${?TWILIO_SID}
  authToken  = ${?TWILIO_TOKEN}
  fromNumber = ${?TWILIO_PHONE_NUMBER}
}

cache {
  verificationCode {
    expireMinutes = 5
  }
}
